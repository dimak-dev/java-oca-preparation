= Constructors
:toc:
:toc-title: Содержание
:toclevels: 3

== Назначение

Тема "Constructors" является фундаментальной для понимания создания объектов в Java.
Конструкторы управляют процессом инициализации объектов, определяют правила вызова `this()` и `super()`,
а также порядок инициализации полей класса. Понимание этих концепций критически важно для экзамена OCA
и правильного проектирования классов в Java.

== Теория

=== Определение конструктора

Конструктор - это специальный метод, который вызывается при создании объекта класса.
Конструкторы имеют особые характеристики:

* Имя конструктора должно совпадать с именем класса
* Конструкторы не имеют возвращаемого типа (даже `void`)
* Конструкторы не могут быть статическими
* Если не определен явно, компилятор создает конструктор по умолчанию
* Конструктор всегда вызывается оператором `new`

=== Типы конструкторов

**Конструктор по умолчанию:**

* Не принимает параметров
* Создается автоматически, если не определен другой конструктор
* Инициализирует поля значениями по умолчанию

**Параметризованный конструктор:**

* Принимает один или несколько параметров
* Позволяет инициализировать объект конкретными значениями
* При его определении конструктор по умолчанию не создается автоматически

=== Использование this() и super()

**Вызов this():**

* Используется для вызова другого конструктора того же класса
* Должен быть первой строкой в конструкторе
* Помогает избежать дублирования кода инициализации

**Вызов super():**

* Используется для вызова конструктора родительского класса
* Должен быть первой строкой в конструкторе
* Если не указан явно, автоматически вызывается `super()` без параметров

=== Порядок инициализации объектов

При создании объекта выполняются следующие шаги в строгом порядке:

. **Инициализация статических полей и блоков** (при первом обращении к классу)
. **Инициализация полей экземпляра** (в порядке объявления)
. **Выполнение блоков инициализации экземпляра**
. **Выполнение конструктора** (начиная с вызова super())

== Примеры кода

=== Пример 1: Базовые конструкторы

Класс `BasicConstructorsDemo` демонстрирует различные типы конструкторов:

[source,java]
----
include::../../src/com/ru/oca/constructors/BasicConstructorsDemo.java[]
----

**Ключевые аспекты:**

* Конструктор по умолчанию для инициализации значениями по умолчанию
* Параметризованный конструктор для инициализации конкретными значениями
* Использование `this` для обращения к полям класса при совпадении имен
* Демонстрация того, как компилятор автоматически создает конструктор по умолчанию

=== Пример 2: Использование this() и super()

Класс `ConstructorChainingDemo` показывает цепочку вызовов конструкторов:

[source,java]
----
include::../../src/com/ru/oca/constructors/ConstructorChainingDemo.java[]
----

**Ключевые аспекты:**

* Использование `this()` для вызова другого конструктора того же класса
* Использование `super()` для вызова конструктора родительского класса
* Правила размещения вызовов `this()` и `super()` в первой строке
* Цепочка инициализации от родительского класса к дочернему

=== Пример 3: Порядок инициализации

Класс `InitializationOrderDemo` демонстрирует порядок выполнения инициализации:

[source,java]
----
include::../../src/com/ru/oca/constructors/InitializationOrderDemo.java[]
----

**Ключевые аспекты:**

* Порядок выполнения статических блоков и полей
* Порядок выполнения блоков инициализации экземпляра
* Порядок выполнения конструкторов в иерархии наследования
* Влияние наследования на последовательность инициализации

== Примеры вопросов

=== Вопрос 1
Какой из следующих конструкторов является правильным для класса `Car`?

* A) `public Car() { }` ✓ ПРАВИЛЬНО
* B) `public void Car() { }` ❌ НЕВЕРНО
* C) `private static Car() { }` ❌ НЕВЕРНО
* D) `public Car void() { }` ❌ НЕВЕРНО

*Правильный ответ:* A - Конструктор не имеет возвращаемого типа и не может быть статическим.

=== Вопрос 2
Что произойдет, если в конструкторе вызвать `this()` не в первой строке?

* A) Код скомпилируется без ошибок ❌ НЕВЕРНО
* B) Возникнет ошибка компиляции ✓ ПРАВИЛЬНО
* C) Возникнет исключение во время выполнения ❌ НЕВЕРНО
* D) Конструктор будет работать, но с предупреждением ❌ НЕВЕРНО

*Правильный ответ:* B - Вызов `this()` или `super()` должен быть первой строкой в конструкторе.

=== Вопрос 3
Что произойдет, если класс не содержит ни одного конструктора?

* A) Код не скомпилируется ❌ НЕВЕРНО
* B) Объекты этого класса нельзя будет создать ❌ НЕВЕРНО
* C) Компилятор автоматически создаст конструктор по умолчанию ✓ ПРАВИЛЬНО
* D) Класс будет считаться абстрактным ❌ НЕВЕРНО

*Правильный ответ:* C - Если конструкторы не определены, компилятор создает конструктор по умолчанию без параметров.

== Типичные ошибки

=== Ошибка 1: Возвращаемый тип в конструкторе
Попытка указать возвращаемый тип для конструктора приведет к ошибке компиляции:
[source,java]
----
public void MyClass() { } // ОШИБКА! Это не конструктор, а метод
----

**Решение:** Конструкторы не должны иметь возвращаемый тип, даже `void`.

=== Ошибка 2: Неправильное размещение this() или super()
Вызов `this()` или `super()` не в первой строке конструктора:
[source,java]
----
public MyClass(int value) {
    System.out.println("Creating object");
    this(); // ОШИБКА! Должно быть первой строкой
}
----

**Решение:** Вызовы `this()` и `super()` должны быть первой строкой в конструкторе.

=== Ошибка 3: Потеря конструктора по умолчанию
После создания параметризованного конструктора забывают о том, что конструктор по умолчанию больше не создается автоматически:
[source,java]
----
public class MyClass {
    public MyClass(int value) { }
}
MyClass obj = new MyClass(); // ОШИБКА! Нет конструктора без параметров
----

**Решение:** Если нужен конструктор по умолчанию, определите его явно.

== Связанные API

* `Object()` - конструктор базового класса Object
* `Class.newInstance()` - создание объекта через рефлексию
* `Constructor.newInstance()` - создание объекта через конкретный конструктор

== Связанные темы

* xref:../oo-concepts/index.adoc[OO Concepts]
* xref:../inheritance/index.adoc[Working with Inheritance]
* xref:../methods/index.adoc[Working with Methods]
* xref:../java-basics/index.adoc[Java Basics]
